<div class="sessions px-4">
    <div class="page-header animate-fade-in">
        <div>
            <h1>ğŸ“… Sessions</h1>
            <p>Manage training sessions, practices, and tournaments</p>
        </div>
        <div class="header-actions" *ngIf="userRole === 'Admin'">
            <button class="btn btn-outline">ğŸ“‹ View Calendar</button>
            <button class="btn btn-primary animate-scale-in" (click)="openModal()">+ New Session</button>
        </div>
    </div>

    <!-- Sessions Cards -->
    <div class="sessions-grid animate-stagger" *ngIf="sessions.length > 0">
        <div class="session-card" *ngFor="let s of sessions" [class.ongoing]="s.status === 'Ongoing'"
            [class.full]="s.status === 'Full'">
            <div class="session-card-header">
                <div class="session-type-icon">{{ getTypeIcon(s.type) }}</div>
                <div class="session-info">
                    <h3>{{ s.title }}</h3>
                    <p class="session-type">{{ s.type }}</p>
                </div>
                <div class="session-header-actions-wrapper">
                    <div class="session-header-actions" *ngIf="userRole === 'Admin'">
                        <button class="action-btn-sm" (click)="openEditModal(s)" title="Edit">âœï¸</button>
                        <button class="action-btn-sm danger" (click)="deleteSession(s.id)" title="Delete">ğŸ—‘ï¸</button>
                    </div>
                    <span class="badge" [ngClass]="getStatusClass(s.status)">{{ s.status }}</span>
                </div>
            </div>

            <div class="session-details-grid">
                <div class="detail-item"><span class="detail-icon">ğŸ“…</span>
                    <div>
                        <p class="detail-label">Date</p>
                        <p class="detail-value">{{ s.date | date:'EEE, dd MMM' }}</p>
                    </div>
                </div>
                <div class="detail-item"><span class="detail-icon">â°</span>
                    <div>
                        <p class="detail-label">Time</p>
                        <p class="detail-value">{{ s.time }}</p>
                    </div>
                </div>
                <div class="detail-item"><span class="detail-icon">ğŸŸï¸</span>
                    <div>
                        <p class="detail-label">Court</p>
                        <p class="detail-value">{{ s.court }}</p>
                    </div>
                </div>
                <div class="detail-item"><span class="detail-icon">ğŸ‘¨â€ğŸ«</span>
                    <div>
                        <p class="detail-label">Coach</p>
                        <p class="detail-value">{{ s.coach }}</p>
                    </div>
                </div>
            </div>

            <div class="capacity-section">
                <div class="capacity-header">
                    <span>ğŸ‘¥ Players</span>
                    <span class="capacity-count" [class.full-text]="s.players === s.maxPlayers">{{ s.players }}/{{
                        s.maxPlayers }}</span>
                </div>
                <div class="capacity-bar-full">
                    <div class="capacity-fill" [style.width.%]="(s.players / s.maxPlayers) * 100"
                        [class.full-fill]="s.players === s.maxPlayers"></div>
                </div>
                <div class="capacity-spots" *ngIf="s.status !== 'Full' && s.status !== 'Completed'">
                    {{ s.maxPlayers - s.players }} spot{{ s.maxPlayers - s.players !== 1 ? 's' : '' }} remaining
                </div>
            </div>

            <div class="session-footer">
                <div class="session-fee">
                    <span class="fee-label">Session Fee</span>
                    <span class="fee-value">â‚¹{{ s.fee }}</span>
                </div>
                <div class="session-actions">
                    <button class="btn btn-sm btn-outline" (click)="openEditModal(s)"
                        *ngIf="userRole === 'Admin'">Edit</button>
                    <button class="btn btn-sm btn-primary" *ngIf="s.status === 'Upcoming'"
                        [disabled]="s.players >= s.maxPlayers">
                        {{ s.players >= s.maxPlayers ? 'Full' : '+ Join' }}
                    </button>
                </div>
            </div>
        </div>
    </div>
    <app-loading-state *ngIf="sessions.length === 0" [isLoading]="isLoading" emptyIcon="ğŸ“…"
        emptyTitle="No sessions found"
        [emptyMessage]="userRole === 'Admin' ? 'Create a new training, practice, or tournament session to see it here.' : 'Check back later for upcoming club sessions and tournaments.'">
    </app-loading-state>
</div>

<!-- â•â•â• ADD / EDIT SESSION MODAL â•â•â• -->
<div class="modal-overlay" *ngIf="showModal" (click)="closeModal()">
    <div class="modal modal-lg" (click)="$event.stopPropagation()">
        <div class="modal-header">
            <div class="modal-title-wrap">
                <span class="modal-icon">{{ editMode ? 'âœï¸' : 'ğŸ“…' }}</span>
                <div>
                    <h3>{{ editMode ? 'Edit Session' : 'Create New Session' }}</h3>
                    <p class="modal-subtitle">{{ editMode ? 'Update session details' : 'Schedule a training or practice
                        session' }}</p>
                </div>
            </div>
            <button class="close-btn" (click)="closeModal()">âœ•</button>
        </div>

        <div class="modal-body">
            <div class="form-section-title">Session Info</div>
            <div class="form-group">
                <label>Session Title *</label>
                <input type="text" [(ngModel)]="newSession.title" placeholder="e.g. Morning Drills, Beginner Basics...">
            </div>
            <div class="grid-2">
                <div class="form-group">
                    <label>Session Type *</label>
                    <select [(ngModel)]="newSession.type">
                        <option value="">Select Type</option>
                        <option value="Training">ğŸ¯ Training</option>
                        <option value="Practice">ğŸ¸ Practice</option>
                        <option value="Tournament">ğŸ† Tournament</option>
                        <option value="Friendly">ğŸ¤ Friendly</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Status</label>
                    <select [(ngModel)]="newSession.status">
                        <option value="Upcoming">Upcoming</option>
                        <option value="Ongoing">Ongoing</option>
                        <option value="Completed">Completed</option>
                        <option value="Cancelled">Cancelled</option>
                    </select>
                </div>
            </div>

            <div class="form-section-title">Schedule</div>
            <div class="grid-3">
                <div class="form-group">
                    <label>Date *</label>
                    <input type="date" [(ngModel)]="newSession.date">
                </div>
                <div class="form-group">
                    <label>Start Time *</label>
                    <input type="time" [(ngModel)]="newSession.time">
                </div>
                <div class="form-group">
                    <label>Court *</label>
                    <select [(ngModel)]="newSession.court">
                        <option value="">Select Court</option>
                        <option value="Court A">Court A</option>
                        <option value="Court B">Court B</option>
                        <option value="Court C">Court C</option>
                        <option value="All Courts">All Courts</option>
                    </select>
                </div>
            </div>

            <div class="form-section-title">Capacity & Fee</div>
            <div class="grid-3">
                <div class="form-group">
                    <label>Coach / Trainer</label>
                    <input type="text" [(ngModel)]="newSession.coach" placeholder="e.g. Coach Rajan">
                </div>
                <div class="form-group">
                    <label>Max Players</label>
                    <input type="number" [(ngModel)]="newSession.maxPlayers" min="1" max="50">
                </div>
                <div class="form-group">
                    <label>Session Fee (â‚¹)</label>
                    <input type="number" [(ngModel)]="newSession.fee" min="0" placeholder="0">
                </div>
            </div>

            <div class="form-error" *ngIf="formError">âš ï¸ {{ formError }}</div>
        </div><!-- /.modal-body -->
        <div class="modal-footer">
            <button class="btn btn-outline" (click)="closeModal()">Cancel</button>
            <button class="btn btn-primary" (click)="saveSession()">
                {{ editMode ? 'ğŸ’¾ Save Changes' : 'âœ… Create Session' }}
            </button>
        </div>
    </div>