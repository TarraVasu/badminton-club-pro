<div class="dashboard px-4">
    <!-- Live Match Ticker -->
    <div class="live-ticker-container" *ngIf="liveMatches.length > 0">
        <div class="ticker-label">LIVE NOW</div>
        <div class="ticker-wrapper">
            <div class="ticker-content">
                <div class="ticker-item" *ngFor="let m of liveMatches">
                    <span class="p1">{{ m.player1 }}</span>
                    <span class="score">{{ m.score1 }} - {{ m.score2 }}</span>
                    <span class="p2">{{ m.player2 }}</span>
                    <span class="court">{{ m.court }}</span>
                </div>
                <!-- Duplicate for seamless loop -->
                <div class="ticker-item" *ngFor="let m of liveMatches">
                    <span class="p1">{{ m.player1 }}</span>
                    <span class="score">{{ m.score1 }} - {{ m.score2 }}</span>
                    <span class="p2">{{ m.player2 }}</span>
                    <span class="court">{{ m.court }}</span>
                </div>
            </div>
        </div>
    </div>
    <div class="hero-banner animate-fade-in">
        <div class="hero-content" *ngIf="userRole === 'Admin'">
            <h1>Welcome back, <span>Admin!</span></h1>
            <p>Your club management dashboard. Here is a quick overview of today's activities, matches, and revenue.</p>
        </div>
        <div class="hero-content" *ngIf="userRole === 'Player'">
            <h1>Ready to play, <span>Champion?</span></h1>
            <p>Welcome to the player lounge. Check out your rankings, upcoming sessions, and recent matches.</p>
        </div>
        <div class="hero-actions" *ngIf="userRole === 'Admin'">
            <button class="btn btn-outline"
                style="background: rgba(255,255,255,0.05); border-color: rgba(255,255,255,0.2)"
                (click)="exportReport()">ğŸ“¤ Export Report</button>
            <button class="btn btn-primary animate-scale-in" style="box-shadow: 0 0 15px rgba(0,212,170,0.4)"
                (click)="goTo('matches')">+ Add Match</button>
        </div>
    </div>

    <!-- Stats Grid -->
    <div class="grid-4 mb-24 animate-stagger">
        <div class="stat-card green card-3d">
            <div class="stat-icon green">ğŸ‘¥</div>
            <div class="stat-info">
                <div class="stat-value">{{ stats.totalPlayers }}</div>
                <div class="stat-label">Total Players</div>
                <div class="stat-change up">â†‘ 2 this month</div>
            </div>
        </div>
        <div class="stat-card green card-3d" *ngIf="userRole === 'Player'">
            <div class="stat-icon green">ğŸ‘¥</div>
            <div class="stat-info">
                <div class="stat-value">{{ stats.totalPlayers }}</div>
                <div class="stat-label">Club Members</div>
                <div class="stat-change up">â†‘ 2 this month</div>
            </div>
        </div>
        <div class="stat-card purple card-3d">
            <div class="stat-icon purple">ğŸ¸</div>
            <div class="stat-info">
                <div class="stat-value">{{ stats.totalMatches }}</div>
                <div class="stat-label">Total Matches</div>
                <div class="stat-change up">{{ stats.liveMatches }} live now</div>
            </div>
        </div>
        <div class="stat-card orange card-3d">
            <div class="stat-icon orange">ğŸ“…</div>
            <div class="stat-info">
                <div class="stat-value">{{ stats.upcomingSessions }}</div>
                <div class="stat-label">Upcoming Sessions</div>
                <div class="stat-change up">â†‘ Today 2</div>
            </div>
        </div>
        <div class="stat-card blue card-3d" *ngIf="userRole === 'Admin'">
            <div class="stat-icon blue">ğŸ’°</div>
            <div class="stat-info">
                <div class="stat-value">â‚¹{{ stats.totalRevenue / 1000 | number:'1.1-1' }}K</div>
                <div class="stat-label">Total Revenue</div>
                <div class="stat-change down">{{ stats.pendingPayments }} pending</div>
            </div>
        </div>
        <!-- Player Specific Card -->
        <div class="stat-card gold card-3d" *ngIf="userRole === 'Player'">
            <div class="stat-icon gold">ğŸ†</div>
            <div class="stat-info">
                <div class="stat-value">TOP 10</div>
                <div class="stat-label">Your Standing</div>
                <div class="stat-change up">â†‘ Improve rank</div>
            </div>
        </div>
    </div>

    <!-- Main Grid -->
    <div class="main-grid">
        <!-- Recent Matches -->
        <div class="card card-3d">
            <div class="card-header">
                <h3>ğŸ¯ Recent Matches</h3>
                <button class="btn btn-sm btn-outline" (click)="goTo('matches')">View All</button>
            </div>
            <table class="data-table" *ngIf="recentMatches.length > 0">
                <thead>
                    <tr>
                        <th>Players</th>
                        <th>Score</th>
                        <th>Court</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let m of recentMatches">
                        <td>
                            <div class="match-players">
                                <span class="p1">{{ m.player1 }}</span>
                                <span class="vs">VS</span>
                                <span class="p2">{{ m.player2 }}</span>
                            </div>
                        </td>
                        <td>
                            <span class="score" *ngIf="m.status !== 'Scheduled'">{{ m.score1 }} - {{ m.score2 }}</span>
                            <span class="score" *ngIf="m.status === 'Scheduled'">TBD</span>
                        </td>
                        <td><span class="court-tag">{{ m.court }}</span></td>
                        <td>
                            <span class="badge" [ngClass]="getMatchStatusClass(m.status)">
                                {{ m.status === 'Live' ? 'ğŸ”´ ' + m.status : m.status }}
                            </span>
                        </td>
                    </tr>
                </tbody>
            </table>
            <div class="empty-state" style="padding: 30px 10px; margin: 0" *ngIf="recentMatches.length === 0">
                <div class="empty-icon" style="font-size: 32px">ğŸ¯</div>
                <h3 style="font-size: 16px">No recent matches</h3>
            </div>
        </div>

        <!-- Right Panel -->
        <div class="right-panel">
            <!-- Top Players -->
            <div class="card" style="margin-bottom: 20px;">
                <div class="card-header">
                    <h3>ğŸ† Top Players</h3>
                    <button class="btn btn-sm btn-outline" (click)="goTo('leaderboard')">Full Board</button>
                </div>
                <div class="top-players animate-stagger" *ngIf="topPlayers.length > 0">
                    <div class="top-player" *ngFor="let p of topPlayers; let i = index">
                        <span class="rank" [ngClass]="getRankClass(i + 1)">{{ getRankEmoji(i + 1) }}</span>
                        <div class="avatar-sm" [style.background]="getAvatarColor(i)">
                            <img *ngIf="p.image" [src]="p.image" alt="Avatar">
                            <span *ngIf="!p.image">{{ p.avatar }}</span>
                        </div>
                        <div class="player-info">
                            <p class="player-name">{{ p.name }}</p>
                            <p class="player-pts">{{ p.points }} pts Â· {{ p.wins }}W {{ p.losses }}L</p>
                        </div>
                        <div class="win-rate">
                            <span>{{ p.winRate }}%</span>
                            <div class="progress-bar">
                                <div class="progress" [style.width.%]="p.winRate"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="empty-state" style="padding: 30px 10px; margin: 0" *ngIf="topPlayers.length === 0">
                    <div class="empty-icon" style="font-size: 32px">ğŸ†</div>
                    <h3 style="font-size: 16px">No top players</h3>
                </div>
            </div>

            <!-- Today's Sessions -->
            <div class="card">
                <div class="card-header">
                    <h3>ğŸ“… Today's Sessions</h3>
                    <button class="btn btn-sm btn-outline" (click)="goTo('sessions')">View All</button>
                </div>
                <div class="session-list animate-stagger" *ngIf="todaySessions.length > 0">
                    <div class="session-item" *ngFor="let s of todaySessions">
                        <div class="session-time">{{ s.time }}</div>
                        <div class="session-details">
                            <p class="session-title">{{ s.title }}</p>
                            <p class="session-meta">{{ s.court }} Â· {{ s.coach }}</p>
                            <div class="session-capacity">
                                <div class="capacity-bar">
                                    <div class="capacity-fill" [style.width.%]="(s.players / s.maxPlayers) * 100"></div>
                                </div>
                                <span>{{ s.players }}/{{ s.maxPlayers }}</span>
                            </div>
                        </div>
                        <span class="badge" [ngClass]="getSessionStatusClass(s.status)">{{ s.status }}</span>
                    </div>
                </div>
                <div class="empty-state" style="padding: 30px 10px; margin: 0" *ngIf="todaySessions.length === 0">
                    <div class="empty-icon" style="font-size: 32px">ğŸ“…</div>
                    <h3 style="font-size: 16px">No sessions today</h3>
                </div>
            </div>
        </div>
    </div>

    <!-- Activity + Payment Stats -->
    <div class="grid-2 mt-20">
        <div class="card">
            <div class="card-header">
                <h3>ğŸ“ˆ Match Activity (This Week)</h3>
            </div>
            <div class="chart-container" style="height: 250px; position: relative;">
                <canvas baseChart [data]="lineChartData" [options]="lineChartOptions" type="line">
                </canvas>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <h3>ğŸ’³ Payment Overview</h3>
            </div>
            <div class="payment-stats">
                <div class="payment-stat-item" *ngFor="let ps of paymentStats">
                    <div class="ps-left">
                        <span class="ps-dot" [style.background]="ps.color"></span>
                        <span class="ps-label">{{ ps.label }}</span>
                    </div>
                    <div class="ps-right">
                        <span class="ps-value">{{ ps.count }}</span>
                        <span class="ps-amount">â‚¹{{ ps.amount | number }}</span>
                    </div>
                </div>
            </div>
            <div class="glow-divider"></div>
            <div class="quick-actions">
                <button class="btn btn-primary btn-sm" (click)="goTo('payments')">View Payments</button>
                <div class="header-actions" *ngIf="userRole === 'Admin'">
                    <button class="btn btn-primary animate-scale-in" (click)="goTo('matches')">+ Add Match</button>
                    <button class="btn btn-outline btn-sm" (click)="sendReminders()">ğŸ“§ Send Reminders</button>
                </div>
            </div>
        </div>
    </div>
</div>