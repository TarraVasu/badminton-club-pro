<div class="app-container">
  <!-- Mobile sidebar backdrop -->
  <div class="sidebar-backdrop" [class.open]="mobileOpen" (click)="closeMobileMenu()"></div>

  <!-- Sidebar: fixed drawer on mobile -->
  <app-sidebar *ngIf="auth.isLoggedIn" [mobileOpen]="mobileOpen" (collapsedChange)="sidebarCollapsed = $event"
    (closeMenu)="closeMobileMenu()">
  </app-sidebar>

  <div class="main-content">
    <!-- Top Bar -->
    <div class="topbar" *ngIf="auth.isLoggedIn">
      <div class="topbar-left" style="display:flex;align-items:center;gap:12px;">
        <!-- Hamburger for mobile -->
        <button class="mobile-menu-btn" (click)="toggleMobileMenu()">â˜°</button>
        <div>
          <h2>ğŸ¾ Birdie Beasts</h2>
          <p>Premier Badminton Management System</p>
        </div>
      </div>
      <div class="topbar-right">
        <div class="search-box">
          <span class="search-icon">ğŸ”</span>
          <input type="text" placeholder="Search players, matches...">
        </div>
        <div class="icon-btn" title="Notifications">
          ğŸ””
          <span class="badge">3</span>
        </div>
        <div class="icon-btn" title="Settings">âš™ï¸</div>

        <!-- â”€â”€ Theme Toggle â”€â”€ -->
        <button class="theme-toggle-btn" [title]="themeService.isDark ? 'Switch to Light Mode' : 'Switch to Dark Mode'"
          (click)="themeService.toggle()" id="theme-toggle-btn">
          <span class="toggle-icon">{{ themeService.isDark ? 'â˜€ï¸' : 'ğŸŒ™' }}</span>
        </button>

        <div class="user-profile">
          <div class="avatar" (click)="toggleUserDropdown($event)">
            {{ auth.isLoggedIn ? auth.getUserInitial() : '' }}
          </div>
          <div class="user-dropdown" [class.show]="userDropdownOpen" (click)="$event.stopPropagation()">
            <div class="dropdown-header">
              <p class="user-name">{{ auth.user.login_id }}</p>
              <p class="user-role">{{ auth.user.role }}</p>
            </div>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" (click)="handleLogout()">
              <span class="item-icon">ğŸšª</span>
              Logout
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- Page Content -->
    <div class="page-content" [class.no-padding]="!auth.isLoggedIn">
      <router-outlet></router-outlet>
    </div>
  </div>
  <!-- Global 3D / 2D Decorative Elements -->
  <div class="floating-shuttle s1">ğŸ¸</div>
  <div class="floating-shuttle s2">ğŸ¸</div>
  <div class="floating-shuttle s3">ğŸ¸</div>
  <div class="shuttle-streak">ğŸ¸</div>

  <app-toast></app-toast>
  <app-loader></app-loader>
</div>